---
title: "MLB MVP, ROY, and Cy Young Winners"
output: 
  flexdashboard::flex_dashboard:
    theme: 
      version: 4
      bootswatch: lux
runtime: shiny
---

```{r global, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

mlb_mvp <- read_csv("data/mlb_mvp.csv") |>
  select(-...1)
```


MVP
==========================

Inputs {.sidebar}
-------------------------

Explain what the award is

```{r, echo=FALSE}
inputPanel(
  selectInput("mvp_stat", label = "Statistic",
              choices = c("Wins Above Replacement", "Games Played", "At Bats", "Runs Scored", "Hits", "Home Runs", "Runs Batted In", "Stolen Bases", "Bases on Balls", "Hits At Bats", "OBP", "On Base and Slugging %", "Total Bases", "Vote PTS"), selected = "Total Bases")
)
```


Column {data-width=300}
-------------------------

```{r, echo=FALSE}


renderPlot({
  stat_name <- switch(input$mvp_stat,
                      "Total Bases" = "Total Bases",
                      "At Bats" = "At Bats",
                      "Runs Scored" = "Runs Scored",
                      "Vote PTS" = "Vote PTS",
                      "Games Played" = "Games Played",
                      "Hits" = "Hits",
                      "Home Runs" = "Home Runs",
                      "Bases on Balls" = "Bases on Balls",
                      "On Base and Slugging %" = "On Base and Slugging %",
                      "Wins Above Replacement" = "Wins Above Replacement",
                      "Hits At Bats" = "Hits At Bats",
                      "OBP" = "OBP",
                      "Runs Batted In" = "Runs Batted In",
                      "Stolen Bases" = "Stolen Bases")
  
  mlb_mvp |>
    filter(Pitcher == FALSE) |>
    ggplot(aes(x = Year, y = as.numeric(case_when(
      input$mvp_stat == "Total Bases" ~ SLG,
      input$mvp_stat == "At Bats" ~ AB,
      input$mvp_stat == "Runs Scored" ~ R,
      input$mvp_stat == "Vote PTS" ~ Vote_PTS,
      input$mvp_stat == "Games Played" ~ BS_G,
      input$mvp_stat == "Hits" ~ BS_H,
      input$mvp_stat == "Home Runs" ~ BS_HR,
      input$mvp_stat == "Bases on Balls" ~ BS_BB,
      input$mvp_stat == "On Base and Slugging %" ~ OPS,
      input$mvp_stat == "Wins Above Replacement" ~ WAR,
      input$mvp_stat == "Hits At Bats" ~ BA,
      input$mvp_stat == "OBP" ~ OBP,
      input$mvp_stat == "Runs Batted In" ~ RBI,
      input$mvp_stat == "Stolen Bases" ~ SB,
    )))) +
    geom_point() +
    geom_smooth(se = FALSE, color = "blue") +
    labs(y = stat_name)
})

```




ROY
==========================

Column {data-width = 200}
-------------------------

Explain what the award is




Cy Young
==========================

Column {data-width = 200}
-------------------------

Explain what the award is








